#!/bin/bash

See howto.txt in ../design/trainticket

./calls2dv8.py ../design/hotelreservation/call_dependencies.csv ./call_dependencies-hotelreservation.json
./calls2dv8.py ../design/trainticket/CUHK-SE/call_dependencies.csv ./call_dependencies-trainticket-CUHK-SE.json
./calls2dv8.py ../design/trainticket/FUDAN/parse_tag002/call_dependencies.csv ./call_dependencies-trainticket-FUDAN_tag002.json
./calls2dv8.py ../design/trainticket/FUDAN/parse_tag100/call_dependencies.csv ./call_dependencies-trainticket-FUDAN_tag100.json
./calls2dv8.py ../design/trainticket/SEALAB/call_dependencies.csv ./call_dependencies-trainticket-SEALAB.json

./datadependencies2dv8.py ../design/trainticket/CUHK-SE/data_dependencies.csv ./data_dependencies-trainticket-CUHK-SE.json
./datadependencies2dv8.py ../design/trainticket/FUDAN/parse_tag002/data_dependencies.csv ./data_dependencies-trainticket-FUDAN_tag002.json
./datadependencies2dv8.py ../design/trainticket/FUDAN/parse_tag100/data_dependencies.csv ./data_dependencies-trainticket-FUDAN_tag100.json
./datadependencies2dv8.py ../design/trainticket/SEALAB/data_dependencies.csv ./data_dependencies-trainticket-SEALAB.json

/Applications/DV8/bin/dv8-console core:convert-matrix ./call_dependencies-hotelreservation.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./call_dependencies-trainticket-CUHK-SE.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./call_dependencies-trainticket-FUDAN_tag002.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./call_dependencies-trainticket-FUDAN_tag100.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./call_dependencies-trainticket-SEALAB.json

/Applications/DV8/bin/dv8-console core:convert-matrix ./data_dependencies-hotelreservation.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./data_dependencies-trainticket-CUHK-SE.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./data_dependencies-trainticket-FUDAN_tag002.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./data_dependencies-trainticket-FUDAN_tag100.json
/Applications/DV8/bin/dv8-console core:convert-matrix ./data_dependencies-trainticket-SEALAB.json

/Applications/DV8/bin/dv8-console core:merge-matrix -outputFile dependencies-trainticket-CUHK-SE.dv8-dsm ./call_dependencies-trainticket-CUHK-SE.dv8-dsm ./data_dependencies-trainticket-CUHK-SE.dv8-dsm
/Applications/DV8/bin/dv8-console core:merge-matrix -outputFile dependencies-trainticket-FUDAN_tag002.dv8-dsm ./call_dependencies-trainticket-FUDAN_tag002.dv8-dsm ./data_dependencies-trainticket-FUDAN_tag002.dv8-dsm
/Applications/DV8/bin/dv8-console core:merge-matrix -outputFile dependencies-trainticket-FUDAN_tag100.dv8-dsm ./call_dependencies-trainticket-FUDAN_tag100.dv8-dsm ./data_dependencies-trainticket-FUDAN_tag100.dv8-dsm
/Applications/DV8/bin/dv8-console core:merge-matrix -outputFile dependencies-trainticket-SEALAB.dv8-dsm ./call_dependencies-trainticket-SEALAB.dv8-dsm ./data_dependencies-trainticket-SEALAB.dv8-dsm

mkdir dv8-hotelreservation
mkdir dv8-trainticket-CUHK-SE
mkdir dv8-trainticket-FUDAN_tag002
mkdir dv8-trainticket-FUDAN_tag100
mkdir dv8-trainticket-SEALAB

/Applications/DV8/bin/dv8-console arch-issue -outputFolder ./dv8-hotelreservation ./dependencies-hotelreservation.dv8-dsm  
/Applications/DV8/bin/dv8-console arch-issue -outputFolder ./dv8-trainticket-CUHK-SE ./dependencies-trainticket-CUHK-SE.dv8-dsm
/Applications/DV8/bin/dv8-console arch-issue -outputFolder ./dv8-trainticket-FUDAN_tag002 ./dependencies-trainticket-FUDAN_tag002.dv8-dsm
/Applications/DV8/bin/dv8-console arch-issue -outputFolder ./dv8-trainticket-FUDAN_tag100 ./dependencies-trainticket-FUDAN_tag100.dv8-dsm
/Applications/DV8/bin/dv8-console arch-issue -outputFolder ./dv8-trainticket-SEALAB ./dependencies-trainticket-SEALAB.dv8-dsm

./calls2graph2.py ../design/hotelreservation/call_dependencies.csv ./graph-hotelreservation.pdf --width 2 --cropleft 7 --cropbottom 10 --cropright 7 --croptop 5 --optimizeorder
./calls2graph2.py ../design/trainticket/CUHK-SE/call_dependencies.csv ./graph-trainticket-CUHK-SE.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 16 --croptop 5
./calls2graph2.py ../design/trainticket/FUDAN/parse_tag002/call_dependencies.csv ./graph-trainticket-FUDAN_tag002.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 17.1 --croptop 5
./calls2graph2.py ../design/trainticket/FUDAN/parse_tag100/call_dependencies.csv ./graph-trainticket-FUDAN_tag100.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 17.1 --croptop 5
./calls2graph2.py ../design/trainticket/SEALAB/call_dependencies.csv ./graph-trainticket-SEALAB.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 17 --croptop 5 

execute analysis

./crop.py --cropleft 8 --cropright 4 --croptop 8 --cropbottom 8 ./hotelreservation-max_response_times.pdf ./hotelreservation-max_response_times2.pdf
./crop.py --cropleft 8 --cropright 4 --croptop 8 --cropbottom 8 ./hotelreservation-nd.pdf ./hotelreservation-nd2.pdf
./crop.py --cropleft 1 --cropright 8 --croptop 8 --cropbottom 8 ./hotelreservation-slope-vs-nd.pdf ./hotelreservation-slope-vs-nd2.pdf
rm hotelreservation-max_response_times.pdf 
rm hotelreservation-nd.pdf 
rm hotelreservation-slope-vs-nd.pdf 
mv hotelreservation-max_response_times2.pdf hotelreservation-max_response_times.pdf
mv hotelreservation-nd2.pdf hotelreservation-nd.pdf
mv hotelreservation-slope-vs-nd2.pdf hotelreservation-slope-vs-nd.pdf

./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-CUHK-SE-max_response_times.pdf trainticket-CUHK-SE-max_response_times2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-CUHK-SE-nd.pdf trainticket-CUHK-SE-nd2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-CUHK-SE-slope-vs-nd.pdf trainticket-CUHK-SE-slope-vs-nd2.pdf

rm trainticket-CUHK-SE-max_response_times.pdf 
rm trainticket-CUHK-SE-nd.pdf 
rm trainticket-CUHK-SE-slope-vs-nd.pdf 
mv trainticket-CUHK-SE-max_response_times2.pdf trainticket-CUHK-SE-max_response_times.pdf
mv trainticket-CUHK-SE-nd2.pdf trainticket-CUHK-SE-nd.pdf
mv trainticket-CUHK-SE-slope-vs-nd2.pdf trainticket-CUHK-SE-slope-vs-nd.pdf

./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-FUDAN-max_response_times.pdf trainticket-FUDAN-max_response_times2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-FUDAN-nd.pdf trainticket-FUDAN-nd2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-FUDAN-slope-vs-nd.pdf trainticket-FUDAN-slope-vs-nd2.pdf
rm trainticket-FUDAN-max_response_times.pdf 
rm trainticket-FUDAN-nd.pdf 
rm trainticket-FUDAN-slope-vs-nd.pdf 
mv trainticket-FUDAN-max_response_times2.pdf trainticket-FUDAN-max_response_times.pdf
mv trainticket-FUDAN-nd2.pdf trainticket-FUDAN-nd.pdf
mv trainticket-FUDAN-slope-vs-nd2.pdf trainticket-FUDAN-slope-vs-nd.pdf

./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-SEALAB-max_response_times.pdf trainticket-SEALAB-max_response_times2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-SEALAB-nd.pdf trainticket-SEALAB-nd2.pdf
./crop.py --cropleft 8 --cropright 8 --croptop 8 --cropbottom 8 trainticket-SEALAB-slope-vs-nd.pdf trainticket-SEALAB-slope-vs-nd2.pdf
rm trainticket-SEALAB-max_response_times.pdf 
rm trainticket-SEALAB-nd.pdf 
rm trainticket-SEALAB-slope-vs-nd.pdf 
mv trainticket-SEALAB-max_response_times2.pdf trainticket-SEALAB-max_response_times.pdf
mv trainticket-SEALAB-nd2.pdf trainticket-SEALAB-nd.pdf
mv trainticket-SEALAB-slope-vs-nd2.pdf trainticket-SEALAB-slope-vs-nd.pdf

---

./calls2graph2.py ../design/hotelreservation/call_dependencies.csv ./graph-hotelreservation.pdf --width 2 --cropleft 7 --cropbottom 10 --cropright 7 --croptop 5
./calls2graph2.py ../design/trainticket/CUHK-SE/call_dependencies.csv ./graph-trainticket-CUHK-SE.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 18 --croptop 5
./calls2graph2.py ../design/trainticket/FUDAN/parse_tag100/call_dependencies.csv ./graph-trainticket-FUDAN_tag100.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 17.1 --croptop 5
./calls2graph2.py ../design/trainticket/SEALAB/call_dependencies.csv ./graph-trainticket-SEALAB.pdf --width 6.5 --cropleft 18 --cropbottom 10 --cropright 17 --croptop 5 
